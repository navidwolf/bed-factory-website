{% extends "base.html" %}
{% block title %}تکمیل خرید{% endblock %}

{% block content %}
<section class="checkout-section">
    <h1>تکمیل خرید</h1>

    {% if cart_items %}
        <!-- نمایش لیست محصولات در فاکتور -->
        <div class="cart-table">
            {% for item in cart_items %}
            <div class="cart-item">
                <div class="cart-img">
                    <img src="{{ url_for('static', filename='images/' ~ item.image) }}" alt="{{ item.name }}">
                </div>
                <div class="cart-details">
                    <h3>{{ item.name }}</h3>
                    <p class="desc">خلاصه‌ای از محصول</p>
                    <p class="price">{{ "{:,}".format(item.price) }} تومان</p>
                </div>
            </div>
            {% endfor %}
        </div>

        <!-- فرم پرداخت -->
        <form method="POST" action="#" class="checkout-form">
            <input type="text" name="name" placeholder="نام و نام خانوادگی" required>
            <input type="tel" name="phone" placeholder="شماره تماس" dir="rtl" required>
            <input type="email" name="email" placeholder="ایمیل" required>
            <input type="text" name="address" placeholder="آدرس" required>
            <button type="submit">پرداخت و ثبت سفارش</button>
        </form>

        <!-- پیش‌فاکتور -->
        <div class="invoice-box">
            <h3>پیش‌فاکتور</h3>
            <p>جمع کل: 
                {{ "{:,}".format(cart_items | sum(attribute='price')) }} تومان
            </p>
            <button type="submit" form="checkout-form">تأیید و پرداخت</button>
        </div>
    {% else %}
        <p>سبد خرید شما خالی است.</p>
    {% endif %}
</section>
{% endblock %}
