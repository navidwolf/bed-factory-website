{% extends "base.html" %}
{% block title %}سبد خرید{% endblock %}

{% block content %}
<h1>سبد خرید شما</h1>

{% if cart_items %}
<div class="cart-table">
    {% for item in cart_items %}
    <div class="cart-item">
        <div class="cart-img">
            <img src="{{ url_for('static', filename='images/' + item.image) }}" alt="{{ item.name }}">
        </div>
        <div class="cart-details">
            <h3>{{ item.name }}</h3>
            <p class="desc">{{ item.short_desc }}</p>
            <p class="price">{{ "{:,}".format(item.price) }} تومان</p>
        </div>
        <div class="cart-quantity">
            <form method="POST" action="{{ url_for('update_cart', item_id=item.id) }}">
                <button type="submit" name="action" value="decrease">-</button>
                <span>{{ item.quantity }}</span>
                <button type="submit" name="action" value="increase">+</button>
            </form>
        </div>
    </div>
    {% endfor %}
</div>

<div class="invoice-box">
    <p>جمع کل: {{ "{:,}".format(cart_items | sum(attribute='price')) }} تومان</p>
    <a href="{{ url_for('checkout') }}"><button>پرداخت</button></a>
</div>

{% else %}
<p>سبد خرید شما خالی است.</p>
{% endif %}
{% endblock %}
