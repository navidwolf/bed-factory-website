{% extends "base.html" %}
{% block title %}سبد خرید{% endblock %}

{% block content %}
<h1 style="text-align:center; margin-bottom:20px;">سبد خرید شما</h1>

{% if cart_items %}
<table style="width:100%; border-collapse: collapse; margin-bottom:20px;">
    <thead>
        <tr style="background-color:#f5f5f5;">
            <th style="padding:10px; text-align:center;">تصویر</th>
            <th style="padding:10px; text-align:center;">نام محصول</th>
            <th style="padding:10px; text-align:center;">قیمت واحد</th>
            <th style="padding:10px; text-align:center;">تعداد</th>
            <th style="padding:10px; text-align:center;">مجموع</th>
            <th style="padding:10px; text-align:center;">حذف</th>
        </tr>
    </thead>
    <tbody>
        {% for item in cart_items %}
        <tr style="text-align:center; border-bottom:1px solid #ddd;">
            <td><img src="{{ url_for('static', filename='images/' ~ item.product.image) }}" alt="{{ item.product.name }}" style="width:80px; height:80px; object-fit:cover; border-radius:5px;"></td>
            <td>{{ item.product.name }}</td>
            <td>{{ "{:,}".format(item.product.price) }} تومان</td>
            <td>
                <div style="display:flex; justify-content:center; align-items:center; gap:5px;">
                    <form method="POST" action="{{ url_for('decrease_quantity', product_id=item.product.id) }}">
                        <button type="submit" class="btn" style="padding:2px 6px;">-</button>
                    </form>
                    {{ item.quantity }}
                    <form method="POST" action="{{ url_for('increase_quantity', product_id=item.product.id) }}">
                        <button type="submit" class="btn" style="padding:2px 6px;">+</button>
                    </form>
                </div>
            </td>
            <td>{{ "{:,}".format(item.product.price * item.quantity) }} تومان</td>
            <td>
                <form method="POST" action="{{ url_for('remove_from_cart', product_id=item.product.id) }}">
                    <button type="submit" class="btn btn-danger">حذف</button>
                </form>
            </td>
        </tr>
        {% endfor %}
    </tbody>
</table>

<div style="text-align:right; margin-bottom:20px; font-size:18px;">
    <strong>جمع کل: {{ "{:,}".format(total_price) }} تومان</strong>
</div>

<div style="text-align:right;">
    <a href="{{ url_for('checkout_page') }}" class="btn btn-primary" style="padding:10px 20px;">پرداخت</a>
</div>

{% else %}
<p style="text-align:center;">سبد خرید شما خالی است.</p>
{% endif %}
{% endblock %}
